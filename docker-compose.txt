version: '3.8'

services:
  web :
    build : .  # Construire l'image à partir du Dockerfile dans le répertoire courant
    environment :
      ENV : env # Définir les variables d'environnement
    volumes :
      - . :/app # Monter le répertoire courant sur /app dans le conteneur
  web_run :
    extends :
      service : web
    command : python manage.py runserver 0.0.0.0:8000  # Commande à exécuter pour lancer le serveur Django
    ports :
    - " 8000:8000 " # Exposer le port 8000 du conteneur sur le port 8000 de l'hôte



    version: "3.3"

services:
  db:
    image: nouchka/sqlite3:latest  # Utilise l'image Docker de SQLite3 à partir du Docker Hub
    volumes:
      - ./data/db:/root/db   # Monte le répertoire local ./data/db dans /root/db du conteneur
    environment:
      - SQLITE3_DB=oc-lettings-site.sqlite3  # Spécifie le nom de la base de données SQLite3
  web:
    image: oc_p13_lettings:latest   # Utilise l'image Docker pour l'application web à partir du Docker Hub
    command: python manage.py runserver 0.0.0.0:8000  # Commande à exécuter pour lancer le serveur Django
    ports:
      - "8000:8000"  # Exposer le port 8000 du conteneur sur le port 8000 de l'hôte
    depends_on:
      - db  # Assure que le service 'db' est démarré avant le service 'web'